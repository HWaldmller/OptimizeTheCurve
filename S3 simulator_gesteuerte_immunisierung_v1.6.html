<!DOCTYPE HTML>
<html>
<head>

    <meta http-equiv="content-type" content="text/html; charset=ISO-8859-1">
    <style>
        .row {
            display: flex; /* equal height of the children */
        }

        .col {
            flex: 1; /* additionally, equal width */
            padding: 1em;
            border: none;
            background-color: #fdedec;
        }

        .links {
            float: left;
            width: 900px;
        }

        .rechts {
            float: right;
            width: 900px;
        }

        .accordion {
            background-color: #E0ECF8;
            color: #585858;
            cursor: pointer;
            padding: 6px;
            width: 100%;
            border: 2px 0 0;
            text-align: left;
            outline: none;
            font-size: 18px;
            transition: 0.3s;
        }

            .active, .accordion:hover {
                background-color: #A9D0F5;
            }

            .accordion:before {
                content: '\23f7';
                content: '\002B';
                color: #777;
                font-weight: bold;
                float: left;
                margin-left: 2px;
                margin-right: 10px;
            }

        .active:before {
            content: '\23f6';
            content: '\2212';
        }

        .panel {
            padding: 0 18px;
            background-color: #EFF5FB;
            max-height: 0;
            overflow: hidden;
            transition: max-height 0.15s ease-out;
        }
    </style>
</head>

<body>

    <font face="arial" color="black">
        <div class="wrapper">
            <button class="accordion">Zielsetzung: Keine Einschränkung, Eindämmung, Abflachung oder Optimierung</button>
            <div class="panel">
                <div>
                    <input type="radio" id="strategyDoNothing" name="strategy" value="doNothing" />
                    <label for="strategyDoNothing">Keine Einschränkung</label>
                </div>
                <div>
                    <input type="radio" id="strategySuppression" name="strategy" value="suppression" />
                    <label for="strategySuppression">Eindämmung: Maximale Einschränkung der Kontakte zur Minimierung der Zahl der Neuinfektionen</label>
                </div>
                <div>
                    <input type="radio" id="strategySimpleMitigation" name="strategy" value="simpleMitigation" />
                    <label for="strategySimpleMitigation">Abflachung: Gleichbleibende Einschränkung der Kontakte ohne Überlastung des Gesundheitswesens</label>
                </div>
                <div>
                    <input type="radio" id="strategyAdvancedMitigation" name="strategy" value="advancedMitigation" checked="true" />
                    <label for="strategyAdvancedMitigation">Optimierung: Täglich angepasste Einschränkung der Kontakte ohne Überlastung des Gesundheitswesens</label>
                </div>
            </div>
            <button class="accordion">Berücksichtigung der Risikogruppen</button>
            <div class="panel">
                <div>
                    <input type="radio" id="optionEntire" name="option" value="entire" />
                    <label for="optionEntire">Keine besondere Berücksichtigung von Risikogruppen</label>
                </div>
                <div>
                    <input type="radio" id="optionOnlyLowRisk" name="option" value="onlyLowRisk" />
                    <label for="optionOnlyLowRisk">Immunisierung durch Gruppen mit niedrigem Intensiv-Risiko</label>
                </div>
                <div>
                    <input type="radio" id="optionOnlyLowRiskPlusLockdown" name="option" value="onlyLowRiskPlusLockdown" checked="true" />
                    <label for="optionOnlyLowRiskPlusLockdown"> <span title="Sobald ausreichend Menschen gegen das Virus immun sind, breitet sich das Virus nicht mehr epidemieartig aus. Da es zu dem Zeitpunkt noch sehr viele Infizierte gibt, besteht für die Risikogruppe weiterhin ein akutes Ansteckungsrisiko. Der 3-wöchige Lockdown führt zu einem schnellen Abklingen der Infektionen.">Immunisierung durch Gruppen mit niedrigem Intensiv-Risiko und anschließender 3-wöchiger Lockdown</span></label>
                </div>
            </div>

            <button class="accordion">Modellierungsparameter</button>
            <div class="panel">
                <div class="rangeslider">
                    <input type="range" min="0" max="100000000" value="83000000" step="100000"
                           class="myslider" id="sliderPopulation">
                    Die Bevölkerung besteht aus <b><span id="displayPopulation"></span> Menschen</b>.
                </div>
                <div class="rangeslider">
                    <input type="range" min="0" max="100000" value="60000" step="100"
                           class="myslider" id="sliderInitiallyInfected">
                    Zu Beginn sind <b><span id="displayInitiallyInfected"></span> Menschen</b> ansteckend.
                </div>
                <div class="rangeslider">
                    <input type="range" min="0" max="1" value="0.41" step="0.01"
                           class="myslider" id="sliderTransmissionRate">
                    Der Ausbreitungsfaktor beträgt <b><span id="displayTransmissionRate"></span></b>.
                </div>
                <div class="rangeslider">
                    <input type="range" min="0" max="100" value="15" step="1"
                           class="myslider" id="sliderRecoveryRate">
                    Jeden Tag genesen oder sterben <b><span id="displayRecoveryRate"></span>%</b> der Ansteckenden.
                </div>
                <div class="rangeslider">
                    <input type="range" min="0" max="100" value="28"
                           class="myslider" id="sliderHighRiskPopulation">
                    <b><span id="displayHighRiskPopulation"></span>%</b> der Bevölkerung haben ein hohes Intensiv-Risiko.
                </div>
                <div class="rangeslider">
                    <input type="range" min="0" max="1000" value="992"
                           class="myslider" id="sliderICUPercentageHighRisk">
                    In der Gruppe mit hohem Intensiv-Risiko sind <b><span id="displayICUPercentageHighRisk"></span>%</b> der bestätigten Infizierten intensiv-pflichtig.
                </div>
                <div class="rangeslider">
                    <input type="range" min="0" max="1000" value="38"
                           class="myslider" id="sliderICUPercentageLowRisk">
                    In der Gruppe mit niedrigem Intensiv-Risiko sind <b><span id="displayICUPercentageLowRisk"></span>%</b> der bestätigten Infizierten intensiv-pflichtig.
                </div>
                <div class="rangeslider">
                    <input type="range" min="0" max="100" value="100"
                           class="myslider" id="sliderRatioHighRiskGroupCompliance">
                    Die Gruppe mit hohem Intensiv-Risiko beteiligt sich zu <b><span id="displayRatioHighRiskGroupCompliance"></span>%</b> an der besonderen Absicherung.
                </div>
                <div class="rangeslider">
                    <input type="range" min="1" max="10" value="1"
                           class="myslider" id="sliderFactorUnregistered">
                    Von <b><span id="displayFactorUnregistered"></span></b> Infizierten wird eine(r) erkannt und registriert.
                </div>
                <div class="rangeslider">
                    <input type="range" min="0" max="21" value="8"
                           class="myslider" id="sliderDelayTime">
                    Infizierte werden <b><span id="displayDelayTime"></span> Tag(e)</b> nach der Infektion registriert (Inkubationszeit, Testverzug und Meldeverzug).
                </div>
                <div class="rangeslider">
                    <input type="range" min="0" max="20" value="10"
                           class="myslider" id="sliderUncertaintyModelParameters">
                    Die Parameter für die Ausbreitungsgeschwindigkeit sind bis auf <b><span id="displayUncertaintyModelParameters"></span>%</b> genau bekannt.
                </div>
                <div class="rangeslider">
                    <input type="range" min="0" max="20" value="10"
                           class="myslider" id="sliderUncertaintyAntibodyTest">
                    Die Anzahl der Empfänglichen lässt sich über Antikörpertests bis auf <b><span id="displayUncertaintyAntibodyTest"></span>%</b> genau bestimmen.
                </div>
                <div class="rangeslider">
                    <input type="range" min="0" max="20" value="10"
                           class="myslider" id="sliderUncertaintyRatio">
                    Das Risiko einer Intensivpflicht ist bis auf <b><span id="displayUncertaintyRatio"></span>%</b> genau bekannt.
                </div>
            </div>

            <button class="accordion">Kapazität des Gesundheitswesens</button>
            <div class="panel">
                <div class="rangeslider">
                    <input type="range" min="0" max="50000" value="20000" step="100"
                           class="myslider" id="sliderCapacity">
                    Zu Beginn stehen <b><span id="displayCapacity"></span> Intensivbetten</b> für die Behandlung von COVID-19 Patient:Innen zur Verfügung.
                </div>
                <div class="rangeslider">
                    <input type="range" min="0" max="500" value="100" step="10"
                           class="myslider" id="sliderCapacityIncrease">
                    Täglich werden <b><span id="displayCapacityIncrease"></span> neue Intensivbetten</b> für die Behandlung von COVID-19 Patient:Innen geschaffen.
                </div>
            </div>

            <button class="accordion">Kontakteinschränkung (Physical Distancing)</button>
            <div class="panel">
                <div class="rangeslider">
                    <input type="range" min="0" max="100" value="30"
                           class="myslider" id="sliderLowerLevel">
                    In Phasen hoher Kontaktreduktion finden durchschnittlich noch <b><span id="displayLowerLevel"></span>%</b> der gewöhnlichen Kontakte statt.
                </div>

                <div class="rangeslider">
                    <input type="range" min="0" max="100" value="100"
                           class="myslider" id="sliderHigherLevel">
                    In Phasen geringer Kontaktreduktion finden durchschnittlich noch <b><span id="displayHigherLevel"></span>%</b> der gewöhnlichen Kontakte statt.
                </div>
                <div class="rangeslider">
                    <input type="range" min="0" max="10" value="5"
                           class="myslider" id="sliderUncertaintyInteraction">
                    Die täglichen Kontakte weichen um bis zu <b><span id="displayUncertaintyInteraction"></span>%-Punkte</b> von den durchschnittlichen Kontakten ab.
                </div>
                <div class="rangeslider">
                    <input type="range" min="0" max="730" value="180"
                           class="myslider" id="sliderEndDate">
                    Nach <b><span id="displayEndDate"></span> Tag(en)</b> dürfen alle uneingeschränkten Kontakt zu anderen Personen aus der Gesamtgruppe haben.
                </div>
                <div class="rangeslider">
                    <input type="range" min="0" max="100" value="85"
                           class="myslider" id="sliderInteractionAfterEndDate">
                    Nach Beendigung der Maßnahmen treten durchschnittlich <b><span id="displayInteractionAfterEndDate"></span>%</b> der gewöhnlichen Kontakte auf.
                </div>
            </div>

            <button class="accordion">Simulationsparameter</button>
            <div class="panel">
                <div class="rangeslider">
                    <input type="range" min="30" max="730" value="360" step="10"
                           class="myslider" id="sliderDuration">
                    Es wird der Zeitraum der nächsten <b><span id="displayDuration"></span>Tagen</b> simuliert.
                </div>

                <div class="rangeslider">
                    <input type="range" min="10" max="100" value="10"
                           class="myslider" id="sliderSimulations">
                    Für die Statistik werden <b><span id="displaySimulations"></span> Simulationen</b> durchgeführt.
                </div>
            </div>
        </div>


        <div class="row">
            <div class="col">
                <div id="curve_chart_2" style="width: 100%; height: 300px"></div>
            </div>
            <div class="col">
                <div id="curve_chart" style="width: 100%; height: 300px"></div>
            </div>
        </div>
        <div class="row">
            <div class="col">
                <div id="curve_chart_3" style="width: 100%; height: 300px"></div>
            </div>
            <div class="col">
                <div id="curve_chart_4" style="width: 100%; height: 300px"></div>
            </div>
        </div>

        <button class="accordion">Erläuterungen</button>
        <div class="panel">
            <p>
                <div>
                    <b>Abbildung A:</b> Die Grafik zeigt das Verhältnis zwischen dem voraussichtlichen Bedarf an Intensivbetten (blau) und der Verfügbarkeit (rot).
                    Der hellblaue Bereich zeigt die Unsicherheit, also mögliche Abweichungen.
                    Nach oben der größtmögliche und nach unten der minimale Bedarf (statistisches Streuband).
                    Die Anzahl der Simulationen bestimmt das statistische Streuband.
                    Die Form der blauen Linie wird vor allem von dem Maß an sozialen Kontakten bestimmt (siehe Abbildung C).
                </div>
            </p>
            <p>
                <div>
                    <b>Abbildung B:</b> Empfänglich (susceptible) sind nach derzeitigem Wissenstand alle bisher nicht Infizierten (infected) und nicht Genesenen oder Verstorbenen (recovered).
                    Besonders gekennzeichnet ist zum einen der Zeitpunkt, an dem ausreichend Menschen gegen SARS CoV2 immun sind, so dass es zu keinem epidemischen Ausbruch der Krankheit mehr kommt, also die sogenannte Herdenimmunität erreicht ist.
                    Zum anderen der Zeitpunkt, an dem es wieder so wenige Infizierte gibt wie zu Beginn der Simulation.
                </div>
            </p>
            <p>
                <div>
                    <b>Abbildung C:</b> Die Grafik zeigt, wie stark die physischen Kontakte an jedem Tag eingeschränkt werden müssen (gelb) und wie gut dies gelingt (blau).
                    33% bedeutet, dass ein Drittel der gewöhnlichen Kontakte vermieden werden müssen, als einer von drei.
                    Die Abweichung zwischen den beiden Kurven zeigt die Unsicherheit in der Umsetzung der erforderlichen Kontaktzahl und lässt sich über einen Parameter einstellen.
                </div>
            </p>
            <p>
                <div>
                    <b>Abbildung D:</b> Wir gehen in Anlehnung an den <a href="https://www.rki.de/DE/Content/InfAZ/N/Neuartiges_Coronavirus/Situationsberichte/2020-04-12-de.pdf">Lagebericht der RKI vom 12. April 2020</a> davon aus, dass 29% der intensiv-pflichtigen Patienten versterben, solange die Kapazität an Intensivbetten ausreicht. Für Fälle jenseits der Kapazitätsgrenze rechnen wir mit 100%. Zur Einordnung der Anzahl der Verstorbenen seien folgende Vergleichzahlen genannt: In Deutschland sterben jährlich zwischen 800.000 und 900.000 Menschen, die meisten davon an Kreislauferkrankungen und Krebs. Aber auch etwa 72.000 Menschen sterben jährlich an infektiösen Krankheiten und Krankheiten des Atmungssystems (siehe <a href="https://www.rki.de/DE/Content/Gesundheitsmonitoring/Gesundheitsberichterstattung/GBEDownloadsT/sterblichkeit.pdf">Bericht des RKI</a>). Laut einem Bericht der ZEIT sterben jährlich etwa 120.000 Menschen an den Folgen des Rauchens und etwa 74.000 Menschen an den Folgen von Alkoholkonsum oder eine Kombination aus Alkohol- und Tabakkonsum (siehe <a href="https://www.zeit.de/wissen/gesundheit/2015-05/drogenbericht-dhs-drogen-konsum-deutschland">Bericht der ZEIT</a>).
                    An Selbstmord sterben etwa 10.000 Menschen (siehe <a href="https://www-genesis.destatis.de/genesis/online?sequenz=tabelleErgebnis&selectionname=23211-0002&sachmerkmal=TODUR1&sachschluessel=TODESURS78&startjahr=1980">Bericht des Statistisches Bundesamts</a>) und in Verkehrsunfällen etwa 3.000 (siehe <a href="https://www.destatis.de/DE/Themen/Gesellschaft-Umwelt/Verkehrsunfaelle/_inhalt.html">Bericht des Statistisches Bundesamts</a>).
                </div>
            </p>
        </div>

        <!--
    <div id="curve_chart_5" style="width: 100%; height: 500px"></div>
    Für die Berechnung der Auswirkung auf die Wirtschaft gehen wir von einem Schaden von 5 Mrd.  für einen Tag Kontaktreduktion um 80% (Lockdown) aus.
    Diese Zahl basiert auf den Schätzungen des ifo Instituts für den Schaden eines 1-monatigen Lockdowns (siehe <a href="https://www.ifo.de/DocDL/Coronavirus-Pandemie-Strategie-Fuest-Lohse-etal-2020-04.pdf">Studie des ifo Instituts</a>) und ist am unteren Ende angesiedelt.
    Bei einem längeren Lockdown sind aufgrund von Insolvenzen ein deutlich größeren wirtschaftlichen Schaden zu erwarten.
    Weiter gehen wir davon aus, dass 10% Kontaktreduktion kostenneutral zu erreichen sind. Zwischen den beiden Punkten gehen wir von einer linearen Änderung der Kosten über der Kontaktzahl aus.
    -->
        <!--
    Erläuterung:
    <p>
        30% Kontakteinschränkung entspricht in etwa den Maßnahmen der Absage von Großeveranstaltungen (z.B. Fußballspiele mit Publikum, Messen) und der Abriegelung besonders betroffener Gebiete.
        Eine 70%-ige Kontakteinschränkung entspricht den zusätzlichen Maßnahmen der Schließungen von Universitäten, Schulen, Kindergärten, Kitas, Museen, Theatern, Restaurants, Bars, Kneipen, Geschäften (ausgenommen solchen des täglichen Bedarfs) sowie Maßnahmen wie großflächiges Homeoffice und Kontakteinschränkungen auf maximal zwei Personen in der Freizeit.
        Durch zusätzliche Hygienemaßnahmen wie das Tragen von Mundschutz in öffentlichen Räumen (öffentlichen Nahverkehr, Geschäften, Bildungseinrichtungen, Praxen, etc.) und die Desinfektion der Hände beim Betreten derselben können 70% Kontaktreduktion auch mit weniger massiven Schließungen erreicht werden.
    </p>
    -->

        <script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
        <script type="text/javascript">

            var alpha = 0.41;//6.8E-9 * 60300000;      // growth factor
            var beta = 0.15;                    // recovery factor
            var modelUncertainty = 0.1;         // uncertainty in model parameters (0.1 corresponds to 10%)
            var ICUcapacity = 20000;            // initial capacity of ICUs
            var addCapacity = 100;              // capacity in ICUs added every day
            var uInaccur = 0.05;                // inaccuracy of setting interaction level
            var darkRatio = 1;                  // factor by which true number of infections differs from registered number
            var upperLevel = 1.0;               // high level of social interaction (min=0; max=1.0)
            var lowerLevel = 0.3;               // low level of social interaction (min=0; max=1.0)
            var finalLevel = 0.85;              // level of interaction after measures have been revoked
            var numberCycles = 10;              // number of simulation cycles
            var T = 360;                        // time steps for simulation (number of days)
            var Npop = 83000000;                // population size
            var initialInfected = 60000;        // number of invividuals initially infected
            var portionHighRisk = 0.28          // fraction of the population at high risk
            var endDate = 180;                  // day at which the restrictions are revoked
            var strategy = 3;                   // 0: do nothing; 1: suppression; 2: flatten the curve; 3: optimize the curve
            var option = 2;                     // 0: entire population; 1: low-risk population; 2: including 3-week lockdown
            var ratioHighRisk = 0.0992;         // ratio of infections leading to ICU requirement for entire population
            var ratioLowRisk = 0.0038;          // ratio of infections leading to ICU requirement for low risk population
            var delay = 8;                      // time steps that registration is delayed with respect to infection

            var accuracyAntibodyTests = 0.1;    // accuracy of the antibody tests
            var uncertaintyRatios = 0.1;        // uncertainty of the ratioHighRisk and ratioLowRisk
            var ratioHighRiskCompliance = 1;    // ratio of compliance of high risk group with measures



            var accordion = document.getElementsByClassName("accordion");
            var i;

            for (i = 0; i < accordion.length; i++) {
                accordion[i].addEventListener("click", function () {
                    this.classList.toggle("active");
                    var panel = this.nextElementSibling;
                    if (panel.style.maxHeight) panel.style.maxHeight = null;
                    else panel.style.maxHeight = panel.scrollHeight + "px";
                });
            }

            // determine results
            calculate();

            // get parameters from user interfacce

            // set parameters for target of no restrictions
            var radioButtonStrategy = document.getElementById("strategyDoNothing");
            radioButtonStrategy.onchange = function () {
                strategy = 0;
                var rangesliderLowerLevel = document.getElementById("sliderLowerLevel");
                rangesliderLowerLevel.value = 100;
                var displayliderLowerLevel = document.getElementById("displayLowerLevel");
                displayliderLowerLevel.innerHTML = 100;
                lowerLevel = 1;
                var rangesliderHigherLevel = document.getElementById("sliderHigherLevel");
                rangesliderHigherLevel.value = 100;
                var displayliderHigherLevel = document.getElementById("displayHigherLevel");
                displayliderHigherLevel.innerHTML = 100;
                upperLevel = 1;
                calculate();
            }

            // set parameters for target of suppression
            var radioButtonStrategy = document.getElementById("strategySuppression");
            radioButtonStrategy.onchange = function () {
                strategy = 1;
                var rangesliderLowerLevel = document.getElementById("sliderLowerLevel");
                rangesliderLowerLevel.value = 30;
                var displayliderLowerLevel = document.getElementById("displayLowerLevel");
                displayliderLowerLevel.innerHTML = 30;
                lowerLevel = 0.3;
                var rangesliderHigherLevel = document.getElementById("sliderHigherLevel");
                rangesliderHigherLevel.value = 30;
                var displayliderHigherLevel = document.getElementById("displayHigherLevel");
                displayliderHigherLevel.innerHTML = 30;
                upperLevel = 0.3;
                calculate();
            }

            // set parameters for target of optimization
            var radioButtonStrategy = document.getElementById("strategySimpleMitigation");
            radioButtonStrategy.onchange = function () {
                strategy = 2;
                if (option == 0) {
                    var rangesliderLowerLevel = document.getElementById("sliderLowerLevel");
                    rangesliderLowerLevel.value = 37;
                    var displayliderLowerLevel = document.getElementById("displayLowerLevel");
                    displayliderLowerLevel.innerHTML = 37;
                    lowerLevel = 0.37;
                    var rangesliderHigherLevel = document.getElementById("sliderHigherLevel");
                    rangesliderHigherLevel.value = 37;
                    var displayliderHigherLevel = document.getElementById("displayHigherLevel");
                    displayliderHigherLevel.innerHTML = 37;
                    upperLevel = 0.37;
                }
                else {
                    var rangesliderLowerLevel = document.getElementById("sliderLowerLevel");
                    rangesliderLowerLevel.value = 43;
                    var displayliderLowerLevel = document.getElementById("displayLowerLevel");
                    displayliderLowerLevel.innerHTML = 43;
                    lowerLevel = 0.43;
                    var rangesliderHigherLevel = document.getElementById("sliderHigherLevel");
                    rangesliderHigherLevel.value = 43;
                    var displayliderHigherLevel = document.getElementById("displayHigherLevel");
                    displayliderHigherLevel.innerHTML = 43;
                    upperLevel = 0.43;
                }
                calculate();
            }

            // set parameters for target of optimization
            var radioButtonStrategy = document.getElementById("strategyAdvancedMitigation");
            radioButtonStrategy.onchange = function () {
                strategy = 3;
                var rangesliderLowerLevel = document.getElementById("sliderLowerLevel");
                rangesliderLowerLevel.value = 30;
                var displayliderLowerLevel = document.getElementById("displayLowerLevel");
                displayliderLowerLevel.innerHTML = 30;
                lowerLevel = 0.3;
                var rangesliderHigherLevel = document.getElementById("sliderHigherLevel");
                rangesliderHigherLevel.value = 100;
                var displayliderHigherLevel = document.getElementById("displayHigherLevel");
                displayliderHigherLevel.innerHTML = 100;
                upperLevel = 1.0;
                calculate();
            }

            // set parameters for option 0
            var radioButtonStrategy = document.getElementById("optionEntire");
            radioButtonStrategy.onchange = function () {
                option = 0;
                if (strategy == 2) {
                    var rangesliderLowerLevel = document.getElementById("sliderLowerLevel");
                    rangesliderLowerLevel.value = 37;
                    var displayliderLowerLevel = document.getElementById("displayLowerLevel");
                    displayliderLowerLevel.innerHTML = 37;
                    lowerLevel = 0.37;
                    var rangesliderHigherLevel = document.getElementById("sliderHigherLevel");
                    rangesliderHigherLevel.value = 37;
                    var displayliderHigherLevel = document.getElementById("displayHigherLevel");
                    displayliderHigherLevel.innerHTML = 37;
                    upperLevel = 0.37;
                }
                calculate();
            }

            // set parameters for option 1
            var radioButtonStrategy = document.getElementById("optionOnlyLowRisk");
            radioButtonStrategy.onchange = function () {
                option = 1;
                if (strategy == 2) {
                    var rangesliderLowerLevel = document.getElementById("sliderLowerLevel");
                    rangesliderLowerLevel.value = 43;
                    var displayliderLowerLevel = document.getElementById("displayLowerLevel");
                    displayliderLowerLevel.innerHTML = 43;
                    lowerLevel = 0.43;
                    var rangesliderHigherLevel = document.getElementById("sliderHigherLevel");
                    rangesliderHigherLevel.value = 43;
                    var displayliderHigherLevel = document.getElementById("displayHigherLevel");
                    displayliderHigherLevel.innerHTML = 43;
                    upperLevel = 0.43;
                }
                calculate();
            }

            // set parameters for option 2
            var radioButtonStrategy = document.getElementById("optionOnlyLowRiskPlusLockdown");
            radioButtonStrategy.onchange = function () {
                option = 2;
                if (strategy == 2) {
                    var rangesliderLowerLevel = document.getElementById("sliderLowerLevel");
                    rangesliderLowerLevel.value = 43;
                    var displayliderLowerLevel = document.getElementById("displayLowerLevel");
                    displayliderLowerLevel.innerHTML = 43;
                    lowerLevel = 0.43;
                    var rangesliderHigherLevel = document.getElementById("sliderHigherLevel");
                    rangesliderHigherLevel.value = 43;
                    var displayliderHigherLevel = document.getElementById("displayHigherLevel");
                    displayliderHigherLevel.innerHTML = 43;
                    upperLevel = 0.43;
                }
                calculate();
            }


            var rangesliderPopulation = document.getElementById("sliderPopulation");
            var outputPopulation = document.getElementById("displayPopulation");
            outputPopulation.innerHTML = rangesliderPopulation.value;

            rangesliderPopulation.onchange = function () {
                outputPopulation.innerHTML = this.value;
                Npop = Math.round(this.value);
                calculate();
            }

            var rangesliderInitiallyInfected = document.getElementById("sliderInitiallyInfected");
            var outputInitiallyInfected = document.getElementById("displayInitiallyInfected");
            outputInitiallyInfected.innerHTML = rangesliderInitiallyInfected.value;

            rangesliderInitiallyInfected.onchange = function () {
                outputInitiallyInfected.innerHTML = this.value;
                initialInfected = Math.round(this.value);
                calculate();
            }

            var rangesliderTransmissionRate = document.getElementById("sliderTransmissionRate");
            var outputTransmissionRate = document.getElementById("displayTransmissionRate");
            outputTransmissionRate.innerHTML = rangesliderTransmissionRate.value;

            rangesliderTransmissionRate.onchange = function () {
                outputTransmissionRate.innerHTML = this.value;
                alpha = this.value;
                calculate();
            }

            var rangesliderRecoveryRate = document.getElementById("sliderRecoveryRate");
            var outputRecoveryRate = document.getElementById("displayRecoveryRate");
            outputRecoveryRate.innerHTML = rangesliderRecoveryRate.value;

            rangesliderRecoveryRate.onchange = function () {
                outputRecoveryRate.innerHTML = this.value;
                beta = this.value / 100;
                calculate();
            }

            var rangesliderHighRiskPopulation = document.getElementById("sliderHighRiskPopulation");
            var outputHighRiskPopulation = document.getElementById("displayHighRiskPopulation");
            outputHighRiskPopulation.innerHTML = rangesliderHighRiskPopulation.value;

            rangesliderHighRiskPopulation.onchange = function () {
                outputHighRiskPopulation.innerHTML = this.value;
                portionHighRisk = Math.round(this.value) / 100;
                calculate();
            }

            var rangesliderICUPercentageAll = document.getElementById("sliderICUPercentageHighRisk");
            var outputICUPercentageAll = document.getElementById("displayICUPercentageHighRisk");
            outputICUPercentageAll.innerHTML = rangesliderICUPercentageAll.value / 100;

            rangesliderICUPercentageAll.onchange = function () {
                outputICUPercentageAll.innerHTML = this.value / 100;
                ratioHighRisk = Math.round(this.value) / 10000;
                calculate();
            }


            var rangesliderICUPercentageLowRisk = document.getElementById("sliderICUPercentageLowRisk");
            var outputICUPercentageLowRisk = document.getElementById("displayICUPercentageLowRisk");
            outputICUPercentageLowRisk.innerHTML = rangesliderICUPercentageLowRisk.value / 100;

            rangesliderICUPercentageLowRisk.onchange = function () {
                outputICUPercentageLowRisk.innerHTML = this.value / 100;
                ratioLowRisk = Math.round(this.value) / 10000;
                calculate();
            }

            var rangesliderRatioHighRiskGroupCompliance = document.getElementById("sliderRatioHighRiskGroupCompliance");
            var outputRatioHighRiskGroupCompliance = document.getElementById("displayRatioHighRiskGroupCompliance");
            outputRatioHighRiskGroupCompliance.innerHTML = rangesliderRatioHighRiskGroupCompliance.value;

            rangesliderRatioHighRiskGroupCompliance.onchange = function () {
                outputRatioHighRiskGroupCompliance.innerHTML = this.value;
                ratioHighRiskCompliance = this.value / 100;
                console.log(ratioHighRiskCompliance);
                calculate();
            }



            var rangesliderUncertaintyModelParameters = document.getElementById("sliderUncertaintyModelParameters");
            var outputUncertaintyModelParameters = document.getElementById("displayUncertaintyModelParameters");
            outputUncertaintyModelParameters.innerHTML = rangesliderUncertaintyModelParameters.value;

            rangesliderUncertaintyModelParameters.onchange = function () {
                outputUncertaintyModelParameters.innerHTML = this.value;
                modelUncertainty = this.value / 100;
                calculate();
            }

            var rangesliderUncertaintyAntibodyTest = document.getElementById("sliderUncertaintyAntibodyTest");
            var outputUncertaintyAntibodyTest = document.getElementById("displayUncertaintyAntibodyTest");
            outputUncertaintyAntibodyTest.innerHTML = rangesliderUncertaintyAntibodyTest.value;

            rangesliderUncertaintyAntibodyTest.onchange = function () {
                outputUncertaintyAntibodyTest.innerHTML = this.value;
                accuracyAntibodyTests = this.value / 100;
                calculate();
            }

            var rangesliderUncertaintyRatio = document.getElementById("sliderUncertaintyRatio");
            var outputUncertaintyRatio = document.getElementById("displayUncertaintyRatio");
            outputUncertaintyRatio.innerHTML = rangesliderUncertaintyRatio.value;

            rangesliderUncertaintyRatio.onchange = function () {
                outputUncertaintyRatio.innerHTML = this.value;
                uncertaintyRatios = this.value / 100;
                calculate();
            }

            var rangesliderDelayTime = document.getElementById("sliderDelayTime");
            var outputDelayTime = document.getElementById("displayDelayTime");
            outputDelayTime.innerHTML = rangesliderDelayTime.value;

            rangesliderDelayTime.onchange = function () {
                outputDelayTime.innerHTML = this.value;
                delay = Math.round(this.value);
                calculate();
            }


            var rangesliderCapacity = document.getElementById("sliderCapacity");
            var outputCapacity = document.getElementById("displayCapacity");
            outputCapacity.innerHTML = rangesliderCapacity.value;

            rangesliderCapacity.onchange = function () {
                outputCapacity.innerHTML = this.value;
                ICUcapacity = Math.round(this.value);
                calculate();
            }

            var rangesliderCapacityIncrease = document.getElementById("sliderCapacityIncrease");
            var outputCapacityIncrease = document.getElementById("displayCapacityIncrease");
            outputCapacityIncrease.innerHTML = rangesliderCapacityIncrease.value;

            rangesliderCapacityIncrease.onchange = function () {
                outputCapacityIncrease.innerHTML = this.value;
                addCapacity = this.value;
                calculate();
            }

            var rangesliderUncertaintyInteraction = document.getElementById("sliderUncertaintyInteraction");
            var outputUncertaintyInteraction = document.getElementById("displayUncertaintyInteraction");
            outputUncertaintyInteraction.innerHTML = rangesliderUncertaintyInteraction.value;

            rangesliderUncertaintyInteraction.onchange = function () {
                outputUncertaintyInteraction.innerHTML = this.value;
                uInaccur = this.value / 100;
                calculate();
            }

            var rangesliderFactorUnregistered = document.getElementById("sliderFactorUnregistered");
            var outputFactorUnregistered = document.getElementById("displayFactorUnregistered");
            outputFactorUnregistered.innerHTML = rangesliderFactorUnregistered.value;

            rangesliderFactorUnregistered.onchange = function () {
                outputFactorUnregistered.innerHTML = this.value;
                darkRatio = this.value;
                calculate();
            }

            var rangesliderLowerLevel = document.getElementById("sliderLowerLevel");
            var outputLowerLevel = document.getElementById("displayLowerLevel");
            outputLowerLevel.innerHTML = rangesliderLowerLevel.value;

            rangesliderLowerLevel.onchange = function () {
                outputLowerLevel.innerHTML = this.value;
                lowerLevel = this.value / 100;
                calculate();
            }


            var rangesliderHigherLevel = document.getElementById("sliderHigherLevel");
            var outputHigherLevel = document.getElementById("displayHigherLevel");
            outputHigherLevel.innerHTML = rangesliderHigherLevel.value;

            rangesliderHigherLevel.onchange = function () {
                outputHigherLevel.innerHTML = this.value;
                upperLevel = this.value / 100;
                calculate();
            }

            var rangesliderEndDate = document.getElementById("sliderEndDate");
            var outputEndDate = document.getElementById("displayEndDate");

            outputEndDate.innerHTML = rangesliderEndDate.value;

            rangesliderEndDate.onchange = function () {
                if (this.value > T - 1) this.value = T - 1;
                outputEndDate.innerHTML = this.value;
                endDate = Math.round(this.value);

                calculate();
            }

            var rangesliderInteractionAfterEndDate = document.getElementById("sliderInteractionAfterEndDate");
            var outputInteractionAfterEndDate = document.getElementById("displayInteractionAfterEndDate");
            outputInteractionAfterEndDate.innerHTML = rangesliderInteractionAfterEndDate.value;

            rangesliderInteractionAfterEndDate.onchange = function () {
                outputInteractionAfterEndDate.innerHTML = this.value;
                finalLevel = this.value / 100;
                calculate();
            }

            var rangesliderSimulations = document.getElementById("sliderSimulations");
            var outputSimulations = document.getElementById("displaySimulations");
            outputSimulations.innerHTML = rangesliderSimulations.value;

            rangesliderSimulations.onchange = function () {
                outputSimulations.innerHTML = this.value;
                numberCycles = this.value;
                calculate();
            }

            var rangesliderDuration = document.getElementById("sliderDuration");
            var outputDuration = document.getElementById("displayDuration");
            outputDuration.innerHTML = rangesliderDuration.value;

            rangesliderDuration.onchange = function () {
                outputDuration.innerHTML = this.value;
                T = Math.round(this.value);
                // check an potentiall correct end date
                if (T - 1 < endDate) {

                    rangesliderEndDate.value = T - 2;
                    outputEndDate.innerHTML = T - 2;
                    endDate = T - 2;
                }
                calculate();
            }


            function calculate() {

                // variable definition

                var iHerdImmunityReached;           // point in time when herd immunity is reached
                var herdImmunityReached;            // flag indicating whether herd immunity is reached
                var counter;                        // counter for lockdown
                var startLevelReached;
                var startLevelAlwaysReached;
                var iStartLevelReached;
                var redPopOnly;
                var simData = [];

                for (i = 0; i < T + 1; i++) {
                    simData[i] = [];
                }

                // set window size;


                // initialize simulation data
                simData[0][0] = 'Day';
                simData[0][1] = 'Empfängliche';
                simData[0][2] = 'Ansteckende Infizierte';
                simData[0][3] = 'Genesene/Verstorbene';
                simData[0][4] = 'Patienten auf Intensivstation';
                simData[0][5] = 'Umsetzung der Kontakteinschränkung';
                simData[0][6] = 'Plätze auf Intensivstation';
                simData[0][7] = 'min Registered';
                simData[0][8] = 'max Registered';
                simData[0][9] = 'Empfängliche niedriges Risiko';
                simData[0][10] = 'Empfängliche hohes Risiko';
                simData[0][11] = 'Ansteckende Infizierte niedriges Risiko';
                simData[0][12] = 'Ansteckende Infizierte hohes Risiko';
                simData[0][13] = 'Patienten auf Intensivstation niedriges Risiko';
                simData[0][14] = 'Patienten auf Intensivstation hohes Risiko';
                simData[0][15] = "Verstorbene";
                simData[0][16] = "Verstorbene niedriges Risiko";
                simData[0][17] = "Verstorbene hohes Risiko";
                simData[0][18] = "min Verstorbene";
                simData[0][19] = "max Verstorbene";
                simData[0][20] = "Wirtschaftlicher Schaden [in Mrd. ]";
                simData[0][21] = "min wirtschaftlicher Schaden";
                simData[0][22] = "max wirtschaftlicher Schaden";
                simData[0][23] = 'Vorgabe der Kontakteinschränkung';
                simData[0][24] = 'Registrierte Genesene';
                simData[0][25] = 'Registrierte Genesene low risk';
                simData[0][26] = 'Registrierte Genesene high risk';
                simData[0][27] = 'Empfängliche hohes Risiko nicht kompliant';
                simData[0][28] = 'Ansteckende Infizierte hohes Risiko nicht kompliant';
                simData[0][29] = 'Patienten auf Intensivstation hohes Risiko nicht kompliant';
                simData[0][30] = 'Verstorbene hohes Risiko nicht kompliant';
                simData[0][31] = 'Registrierte Genesene high risk nicht kompliant';

                // set model parameters for simulation
                var alphaMod = [];
                var betaMod = [];
                var sus = [];
                var susLR = [];
                var susHR = [];
                var susHRnc = [];
                var inf = [];
                var infLR = [];
                var infHR = [];
                var infHRnc = [];
                var rec = [];
                var dec = [];
                var u = [];


                // set  variations for model parameters
                alphaMod[0] = alpha * (1 + modelUncertainty);
                alphaMod[1] = alpha * (1 - modelUncertainty);
                alphaMod[2] = alpha;
                alphaMod[3] = alpha;
                alphaMod[4] = alpha;

                betaMod[0] = beta;
                betaMod[1] = beta;
                betaMod[2] = beta * (1 + modelUncertainty);
                betaMod[3] = beta * (1 - modelUncertainty);
                betaMod[4] = beta;

                // initialize simulation data
                u[0] = 0;
                for (i = 1; i < T + 1; i++) {
                    for (j = 0; j < 32; j++) {
                        simData[i][j] = 0;
                    }
                    simData[i][7] = Npop;
                    simData[i][18] = Npop;
                    simData[i][6] = ICUcapacity + i * addCapacity;
                    simData[i][21] = 1E10;
                    u[i] = 0;
                }

                for (i = 0; i < 8; i++) {
                    sus[i] = 0;
                    susLR[i] = 0;
                    susHR[i] = 0;
                    susHRnc[i] = 0;
                    inf[i] = 0;
                    infLR[i] = 0;
                    infHR[i] = 0;
                    infHRnc[i] = 0;
                    rec[i] = 0;
                    dec[i] = 0;
                }


                herdImmunityAlwaysReached = true;
                startLevelAlwaysReached = true;
                iHerdImmunity = 0;
                iStartLevelReached = 0;

                for (cycle = 0; cycle < numberCycles; cycle++) {

                    // initialize simulation variables
                    simData[1][0] = 1;
                    if (option == 0) simData[1][1] = Npop;
                    if (option == 1 || option == 2) simData[1][1] = Npop * (1 - portionHighRisk);
                    simData[1][2] = initialInfected * darkRatio;
                    simData[1][3] = 0;
                    simData[1][4] = 0;
                    simData[1][5] = upperLevel;
                    simData[1][6] = ICUcapacity;
                    simData[1][7] = 0;
                    simData[1][8] = 0;
                    simData[1][9] = Npop * (1 - portionHighRisk);
                    simData[1][10] = Npop * portionHighRisk * ratioHighRiskCompliance;
                    simData[1][27] = Npop * portionHighRisk * (1 - ratioHighRiskCompliance);
                    console.log(simData[1][27]);
                    simData[1][11] = initialInfected * (1 - portionHighRisk) * darkRatio;
                    simData[1][12] = initialInfected * portionHighRisk * ratioHighRiskCompliance * darkRatio;
                    simData[1][28] = initialInfected * portionHighRisk * (1 - ratioHighRiskCompliance) * darkRatio;
                    simData[1][13] = initialInfected * (1 - portionHighRisk) * ratioLowRisk;
                    simData[1][14] = initialInfected * portionHighRisk * ratioHighRiskCompliance * ratioHighRisk;
                    simData[1][29] = initialInfected * portionHighRisk * (1 - ratioHighRiskCompliance) * ratioHighRisk;
                    simData[1][15] = 0;
                    simData[1][16] = 0;
                    simData[1][17] = 0;
                    simData[1][18] = 0;
                    simData[1][19] = 0;
                    simData[1][20] = 0;
                    simData[1][21] = 0;
                    simData[1][22] = 0;
                    simData[1][23] = 0;
                    simData[1][24] = 0;
                    simData[1][25] = 0;
                    simData[1][26] = 0;
                    simData[1][30] = 0;
                    simData[1][31] = 0;



                    for (model = 0; model < 5; model++) {
                        herdImmunityReached = false;
                        startLevelReached = false;
                        counter = 0;
                        // calculate amount of infected and recovered for herd immunita
                        nHerdImmunity = Npop - betaMod[model] * Npop / (alphaMod[model] * finalLevel);

                        // loop over time steps
                        for (i = 1; i < T; i++) {

                            redPopOnly = ((option == 1 || option == 2) && (i <= endDate) && (i > 1));

                            // determine relevant population (either entire population of population minus high-risk group)
                            Nrel = Npop;
                            if (option == 1 || option == 2) {
                                if (i <= endDate) Nrel = Npop * (1 - portionHighRisk * ratioHighRiskCompliance);
                                if (i == 1) {
                                    simData[i][1] = Npop;
                                    simData[i][9] = Npop * (1 - portionHighRisk);
                                    simData[i][10] = Npop * portionHighRisk * ratioHighRiskCompliance;
                                    simData[i][27] = Npop * portionHighRisk * (1 - ratioHighRiskCompliance);
                                }
                                if (i == 2) {
                                    simData[i][1] -= Npop * portionHighRisk * ratioHighRiskCompliance;
                                    simData[i][10] -= Npop * portionHighRisk * ratioHighRiskCompliance;
                                    //simData[i][28] -= Npop * portionHighRisk * (1-ratioHighRiskCompliance);
                                }
                            }

                            simData[i][5] = upperLevel;
                            simData[i + 1][5] = upperLevel;

                            // choose the optimal interaction level

                            // predictive model
                            if (strategy == 3) {
                                if (i > delay - 1) {

                                    // loop over all models
                                    for (j = 0; j < 5; j++) {

                                        // calculate impact on population

                                        // initialize prediction
                                        susLR[0] = simData[i - delay][9] * (1 + accuracyAntibodyTests);     // consider worst case 10% Error in susceptibles //(1 + 2 * (Math.random() - 0.5) * 0.1);
                                        susHR[0] = simData[i - delay][10] * (1 + accuracyAntibodyTests);    // consider worst case 10% Error in susceptibles // (1 + 2 * (Math.random() - 0.5) * 0.1);
                                        susHRnc[0] = simData[i - delay][27] * (1 + accuracyAntibodyTests);    // consider worst case 10% Error in susceptibles // (1 + 2 * (Math.random() - 0.5) * 0.1);
                                        sus[0] = susLR[0] + susHR[0] + susHRnc[0];

                                        infLR[0] = simData[i][13] / (ratioLowRisk * (1 - uncertaintyRatios));       // consider worst case 10% error in ratio
                                        infHR[0] = simData[i][14] / (ratioHighRisk * (1 - uncertaintyRatios));      // consider worst case 10% error in ratio
                                        infHRnc[0] = simData[i][29] / (ratioHighRisk * (1 - uncertaintyRatios));      // consider worst case 10% error in ratio
                                        inf[0] = infLR[0] + infHR[0] + infHRnc[0];

                                        // simulate scenarios
                                        for (k = 0; k < 2; k++) {
                                            if (k == 0) u[i] = upperLevel;
                                            else u[i] = lowerLevel;
                                            for (l = 0; l < delay + 1; l++) {
                                                susLR[l + 1] = Math.round(susLR[l] - (u[l + i - delay] + uInaccur) * alphaMod[j] / Nrel * susLR[l] * inf[l]);
                                                susHRnc[l + 1] = Math.round(susHRnc[l] - (u[l + i - delay] + uInaccur) * alphaMod[j] / Nrel * susHRnc[l] * inf[l]);
                                                if (redPopOnly) susHR[l + 1] = susHR[l];
                                                else
                                                    susHR[l + 1] = Math.round(susHR[l] - (u[l + i - delay] + uInaccur) * alphaMod[j] / Nrel * susHR[l] * inf[l]);
                                                sus[l + 1] = susLR[l + 1] + susHR[l + 1] + susHRnc[l + 1];

                                                infLR[l + 1] = Math.round(infLR[l] + (u[l + i - delay] + uInaccur) * alphaMod[j] / Nrel * susLR[l] * inf[l] - betaMod[j] * infLR[l]);
                                                infHRnc[l + 1] = Math.round(infHRnc[l] + (u[l + i - delay] + uInaccur) * alphaMod[j] / Nrel * susHRnc[l] * inf[l] - betaMod[j] * infHRnc[l]);
                                                if (redPopOnly) infHR[l + 1] = infHR[l] - betaMod[j] * infHR[l];
                                                else
                                                    infHR[l + 1] = Math.round(infHR[l] + (u[l + i - delay] + uInaccur) * alphaMod[j] / Nrel * susHR[l] * inf[l] - betaMod[j] * infHR[l]);
                                                inf[l + 1] = infLR[l + 1] + infHR[l + 1] + infHRnc[l + 1];
                                            }
                                            if (infLR[delay + 1] * ratioLowRisk + (infHR[delay + 1] + infHRnc[delay + 1]) * ratioHighRisk > simData[i + 1][6]) simData[i][5] = lowerLevel;
                                        }
                                    }
                                }
                                else simData[i][5] = lowerLevel;
                            }

                            if (herdImmunityReached && counter <= 21 && option == 2) {
                                simData[i][5] = 0.2;
                                counter++;
                            }

                            if (i > endDate) {
                                simData[i][5] = finalLevel;
                            }

                            // if end date is reached, add the high-risk group to the susceptibles
                            if (i == endDate && (option == 1 || option == 2)) simData[i][10] += Npop * portionHighRisk * ratioHighRiskCompliance;

                            if (strategy == 0) simData[i][5] = 1;

                            if (i == T) simData[i][5] = simData[i - 1][5];

                            u[i] = simData[i][5];
                            simData[i][23] = u[i];
                            simData[i][5] += 2 * (Math.random() - 0.5) * uInaccur;
                            if (simData[i][5] < 0) simData[i][5] = 0;

                            // assure consistens display of last data point
                            simData[i + 1][23] = simData[i][23];
                            simData[i + 1][5] = simData[i][5];

                            simData[i + 1][0] = i + 1;
                            simData[i + 1][4] = 0;

                            // determine new number of susceptibles
                            simData[i + 1][9] = Math.round(simData[i][9] - alphaMod[model] / Nrel * simData[i][5] * simData[i][9] * simData[i][2]);
                            simData[i + 1][27] = Math.round(simData[i][27] - alphaMod[model] / Nrel * simData[i][5] * simData[i][27] * simData[i][2]);
                            if (redPopOnly) simData[i + 1][10] = simData[i][10];
                            else simData[i + 1][10] = Math.round(simData[i][10] - alphaMod[model] / Nrel * simData[i][5] * simData[i][10] * simData[i][2]);
                            simData[i + 1][1] = simData[i + 1][9] + simData[i + 1][10] + simData[i + 1][27];

                            // determine new number of infected
                            simData[i + 1][11] = Math.round(simData[i][11] + alphaMod[model] / Nrel * simData[i][5] * simData[i][9] * simData[i][2] - betaMod[model] * simData[i][11]);
                            simData[i + 1][28] = Math.round(simData[i][28] + alphaMod[model] / Nrel * simData[i][5] * simData[i][27] * simData[i][2] - betaMod[model] * simData[i][28]);

                            if (redPopOnly) simData[i + 1][12] = simData[i][12] - betaMod[model] * simData[i][12];
                            else
                                simData[i + 1][12] = Math.round(simData[i][12] + alphaMod[model] / Nrel * simData[i][5] * simData[i][10] * simData[i][2] - betaMod[model] * simData[i][12]);
                            simData[i + 1][2] = simData[i + 1][11] + simData[i + 1][12] + simData[i + 1][28];

                            // determine new number of recovered
                            simData[i + 1][3] = Math.round(simData[i][3] + betaMod[model] * simData[i][2]);

                            // determine new number of registered
                            if (i > delay - 1) {
                                simData[i + 1][13] = Math.round(ratioLowRisk * (1 + 2 * (Math.random() - 0.5) * accuracyAntibodyTests) / darkRatio * simData[i + 1 - delay][11]);
                                simData[i + 1][14] = Math.round(ratioHighRisk * (1 + 2 * (Math.random() - 0.5) * accuracyAntibodyTests) / darkRatio * simData[i + 1 - delay][12]);
                                simData[i + 1][29] = Math.round(ratioHighRisk * (1 + 2 * (Math.random() - 0.5) * accuracyAntibodyTests) / darkRatio * simData[i + 1 - delay][28]);
                                simData[i + 1][4] = simData[i + 1][13] + simData[i + 1][14] + simData[i + 1][29];
                            }

                            // determine number of registered recovered


                            // determine new number of deceased
                            // in case capacity is sufficient
                            if (simData[i + 1][6] > simData[i + 1][4])
                                simData[i + 1][15] = Math.round(simData[i][15] + simData[i + 1][4] * betaMod[model] * 0.29);
                            else
                                simData[i + 1][15] = Math.round(simData[i][15] + simData[i + 1][6] * betaMod[model] * 0.29 + (simData[i + 1][4] - simData[i + 1][6]) * betaMod[model]);

                            // determine economic impact
                            if (simData[i][23] <= 0.2) simData[i + 1][20] = simData[i][20] + 5;
                            if (simData[i][23] > 0.2 && simData[i][23] < 0.9)
                                //simData[i + 1][20] = simData[i][20] + (1 - (3 * Math.pow((simData[i][5] - 0.2) / 0.7, 2) - 2 * Math.pow((simData[i][5] - 0.2) / 0.7, 3))) * 5;
                                simData[i + 1][20] = simData[i][20] + 5 * (1 - (simData[i][23] - 0.2) / 0.7);
                            if (simData[i][23] >= 0.9) simData[i + 1][20] = simData[i][20];

                            // update min and max values
                            if (simData[i + 1][4] > simData[i + 1][8]) simData[i + 1][8] = simData[i + 1][4];
                            if (simData[i + 1][4] < simData[i + 1][7]) simData[i + 1][7] = simData[i + 1][4];

                            if (simData[i + 1][15] > simData[i + 1][19]) simData[i + 1][19] = simData[i + 1][15];
                            if (simData[i + 1][15] < simData[i + 1][18]) simData[i + 1][18] = simData[i + 1][15];

                            if (simData[i + 1][20] > simData[i + 1][22]) simData[i + 1][22] = simData[i + 1][20];
                            if (simData[i + 1][20] < simData[i + 1][21]) simData[i + 1][21] = simData[i + 1][20];

                            // check if herd immunity has been reached for final level of interaction
                            if (simData[i + 1][2] + simData[i + 1][3] > nHerdImmunity && !herdImmunityReached) {
                                herdImmunityReached = true;
                                if (i + 1 > iHerdImmunity) iHerdImmunity = i + 1;
                            }

                            // check if start level is reached (only if herd immunity is reached)
                            if (herdImmunityReached && simData[i + 1][2] < initialInfected && !startLevelReached) {
                                startLevelReached = true;
                                if (i + 1 > iStartLevelReached) iStartLevelReached = i + 1;
                            }
                        }
                        // if herd immunity was not reached for the current model is was not always reached
                        if (!herdImmunityReached) herdImmunityAlwaysReached = false;
                        if (!startLevelReached) startLevelAlwaysReached = false;
                    }
                }

                // extract data for overview
                var viewData1 = [];
                for (i = 0; i < T + 1; i++) {
                    viewData1[i] = [];
                }
                for (i = 0; i < T + 1; i++) {
                    for (j = 0; j < 4; j++) {
                        viewData1[i][j] = simData[i][j];
                    }
                }

                // extract data for overview
                var viewData2 = [];
                for (i = 0; i < T + 1; i++) {
                    viewData2[i] = [];
                }

                for (i = 0; i < T + 1; i++) {
                    viewData2[i][0] = simData[i][0];
                    viewData2[i][1] = simData[i][6];
                    viewData2[i][2] = simData[i][7];
                    viewData2[i][3] = simData[i][4];
                    viewData2[i][4] = simData[i][8];
                    if (i > 0) {
                        viewData2[i][2] = simData[i][7] - simData[i][6];
                        viewData2[i][3] = simData[i][4] - simData[i][7];
                        viewData2[i][4] = simData[i][8] - simData[i][4];
                    }
                }

                var viewData3 = [];
                for (i = 0; i < T + 1; i++) {
                    viewData3[i] = [];
                }
                for (i = 0; i < T + 1; i++) {
                    viewData3[i][0] = simData[i][0];
                    viewData3[i][1] = simData[i][5];
                    viewData3[i][2] = simData[i][23];
                    if (i > 0) {
                        viewData3[i][1] = (-viewData3[i][1] + 1) * 100;
                        viewData3[i][2] = (-viewData3[i][2] + 1) * 100;
                    }
                }

                var viewData4 = [];
                for (i = 0; i < T + 1; i++) {
                    viewData4[i] = [];
                }
                for (i = 0; i < T + 1; i++) {
                    viewData4[i][0] = simData[i][0];
                    viewData4[i][1] = simData[i][18];
                    viewData4[i][2] = simData[i][15];
                    viewData4[i][3] = simData[i][19];
                    if (i > 0) {
                        viewData4[i][1] = simData[i][18];
                        viewData4[i][2] = simData[i][15] - simData[i][18];
                        viewData4[i][3] = simData[i][19] - simData[i][15];
                    }
                }


                // gather data for evaluation of economic impact
                var viewData5 = [];
                for (i = 0; i < T + 1; i++) {
                    viewData5[i] = [];
                }
                for (i = 0; i < T + 1; i++) {
                    viewData5[i][0] = simData[i][0];
                    viewData5[i][1] = simData[i][21];
                    viewData5[i][2] = simData[i][20];
                    viewData5[i][3] = simData[i][22];
                    if (i > 0) {
                        viewData5[i][1] = simData[i][21];
                        viewData5[i][2] = simData[i][20] - simData[i][21];
                        viewData5[i][3] = simData[i][22] - simData[i][20];
                    }
                }

                google.charts.load('current', { 'packages': ['corechart'] });
                google.charts.setOnLoadCallback(drawChart);

                function drawChart() {

                    var data = google.visualization.arrayToDataTable(viewData1);

                    // add annotations
                    data.insertColumn(4, { type: 'string', role: 'annotationText' });
                    data.insertColumn(4, { type: 'string', role: 'annotation' });

                    data.insertColumn(3, { type: 'string', role: 'annotationText' });
                    data.insertColumn(3, { type: 'string', role: 'annotation' });

                    data.insertColumn(2, { type: 'string', role: 'annotationText' });
                    data.insertColumn(2, { type: 'string', role: 'annotation' });

                    data.addColumn({ type: 'string', role: 'annotation' });
                    data.addColumn({ type: 'string', role: 'annotationText' });

                    if (option == 1 || option == 2) {
                        data.setCell(1, 2, 'Empfägliche (susceptible)', 'Risikogruppe geschützt');
                        data.setCell(endDate, 2, 'Empfägliche (susceptible)', 'Schutz für Risikogruppe aufgehoben');
                    }


                    if (herdImmunityAlwaysReached) data.setCell(iHerdImmunity, 8, 'Genesene (recovered)', 'Herdenimmunität immer erreicht');
                    else data.setCell(T - 2, 8, 'Genesene (recovered)', 'Herdenimmunität nicht immer erreicht');

                    if (startLevelAlwaysReached) data.setCell(iStartLevelReached, 5, 'Infizierte (infected)', 'Ansteckungsrisiko immer kleiner als zu Beginn');
                    else data.setCell(T - 2, 5, 'Infizierte (infected)', 'Ansteckungsrisiko nicht immer kleiner als zu Beginn');

                    var options = {
                        title: 'Abbildung B: Immunität und Infizierung in der Bevölkerung',
                        curveType: 'none',
                        legend: { position: 'bottom' },
                        hAxis: {
                            title: 'Zeit [Tage]'
                        },
                        vaxis: {
                            0: { type: "line", targetAxisIndex: 0 },
                            1: { type: "line", targetAxisIndex: 1 },

                        },
                        series: {
                            0: { targetAxisIndex: 0, annotations: { style: { type: 'line', }, stem: { length: 50, color: '#3366CC' } } },
                            1: { targetAxisIndex: 0, annotations: { style: { type: 'line', }, stem: { length: 20, color: '#DC3912' } } },
                            2: { targetAxisIndex: 0, annotations: { style: { type: 'line', }, stem: { length: 50, color: '#FF9900' } } }
                        },
                        backgroundColor: { stroke: 'black', strokeWidth: 2 },
                    };


                    var chart = new google.visualization.ComboChart(document.getElementById('curve_chart'));
                    chart.draw(data, options);

                    var data2 = google.visualization.arrayToDataTable(viewData2);
                    var options2 = {
                        title: 'Abbildung A: Kapazitäten im Gesundheitswesen',
                        curveType: 'none',
                        legend: { position: 'bottom' },
                        vAxes: {
                            0: {},
                            1: { minValue: 0, maxValue: 1 }
                        },
                        isStacked: 'true',
                        hAxis: {
                            title: 'Zeit [Tage]'
                        },
                        seriesType: 'area',
                        enableInteractivity: false,
                        series: {
                            0: { targetAxisIndex: 0, color: '#DC3912', lineWidth: 2, areaOpacity: 0 },
                            1: { targetAxisIndex: 0, color: '#3366CC', lineWidth: 0, areaOpacity: 0, visibleInLegend: false },
                            2: { targetAxisIndex: 0, color: '#3366CC', lineWidth: 2, areaOpacity: 0.2 },
                            3: { targetAxisIndex: 0, color: '#3366CC', lineWidth: 0, areaOpacity: 0.2, visibleInLegend: false },
                        },
                        backgroundColor: 'white',
                        backgroundColor: { stroke: 'black', strokeWidth: 2 },
                        //chartArea: { width: '100%' }
                    };

                    var chart2 = new google.visualization.ComboChart(document.getElementById('curve_chart_2'));
                    chart2.draw(data2, options2);



                    var data3 = google.visualization.arrayToDataTable(viewData3);
                    var options3 = {
                        title: 'Abbildung C: Kontakteinschränkungen',
                        curveType: 'none',
                        legend: { position: 'bottom' },
                        hAxis: {
                            title: 'Zeit [Tage]'
                        },
                        series: {
                            0: { targetAxisIndex: 0, color: '#3366CC', lineWidth: 2, areaOpacity: 0 },
                            1: { targetAxisIndex: 0, color: '#FF9900', lineWidth: 2, areaOpacity: 0 },
                        },
                        vAxis: {
                            viewWindowMode: 'explicit',
                            viewWindow: {
                                max: 100,
                                min: 0
                            }
                        },
                        backgroundColor: { stroke: 'black', strokeWidth: 2 },
                    };
                    var chart3 = new google.visualization.ComboChart(document.getElementById('curve_chart_3'));
                    chart3.draw(data3, options3);


                    var data4 = google.visualization.arrayToDataTable(viewData4);
                    var options4 = {
                        title: 'Abbildung D: Verstorbene',
                        curveType: 'none',
                        legend: { position: 'bottom' },
                        vAxes: {
                            0: {},
                            1: { minValue: 0, maxValue: 1 }
                        },
                        isStacked: 'true',
                        hAxis: {
                            title: 'Zeit [Tage]'
                        },
                        seriesType: 'area',
                        enableInteractivity: false,
                        series: {
                            0: { targetAxisIndex: 0, color: '#3366CC', lineWidth: 0, areaOpacity: 0, visibleInLegend: false },
                            1: { targetAxisIndex: 0, color: '#3366CC', lineWidth: 2, areaOpacity: 0.2 },
                            2: { targetAxisIndex: 0, color: '#3366CC', lineWidth: 0, areaOpacity: 0.2, visibleInLegend: false },
                        },
                        backgroundColor: { stroke: 'black', strokeWidth: 2 },
                    };
                    var chart4 = new google.visualization.ComboChart(document.getElementById('curve_chart_4'));
                    chart4.draw(data4, options4);


                    /*
                    var data5 = google.visualization.arrayToDataTable(viewData5);
                    var options5 = {
                        title: 'Abbildung E: Betrachtung in Hinblick auf den wirtschaftlichen Schaden',
                        curveType: 'none',
                        legend: { position: 'bottom' },
                        vAxes: {
                            0: {},
                            1: { minValue: 0, maxValue: 1 }
                        },
                        isStacked: 'true',
                        hAxis: {
                            title: 'Zeit [Tage]'
                        },
                        seriesType: 'area',
                        enableInteractivity: false,
                        series: {
                            0: { targetAxisIndex: 0, color: '#3366CC', lineWidth: 0, areaOpacity: 0, visibleInLegend: false },
                            1: { targetAxisIndex: 0, color: '#3366CC', lineWidth: 2, areaOpacity: 0.2 },
                            2: { targetAxisIndex: 0, color: '#3366CC', lineWidth: 0, areaOpacity: 0.2, visibleInLegend: false },
                        }
                    };
                    var chart5 = new google.visualization.ComboChart(document.getElementById('curve_chart_5'));
                    chart5.draw(data5, options5);
                    */
                }
            }
        </script>
    </font>
</body>
</html>
